****************************************************************************************************
SEQUENCE STEP SCHEDULE
generated on 12/05/2018 3:03:20 PM by David Paspa
****************************************************************************************************





--------------------------------------------------
SEQUENCE
--------------------------------------------------

Name:- FLUSH
Title:- PH_FLUSH
Description:- Flush to time or flush continuously until stopped with WFI,PW, PS(PW) or PS(WFI).
HMI_FORMAT:- @@STEP_NUM_INT@@,@@STEP_TITLE@@
Class:- EMC3
Level:- PH
STEP_LIST_FORMAT:- JU    S0@@STEP_NUM@@; // STEP-0@@STEP_NUM@@:
ACT_LIST_FORMAT:- JU    @@ACT_CODE@@@@STEP_NUM@@; //ACTION-@@ACT_NUM@@
HeaderName:- C3PFLUS
Version:- 0.6
RevisionHistory:- // SFC Revision History:
// Rev By               Date        CC         Note
// 0.6 Khairul Basar    04-Oct-2009 CC-09/023  S001, verification CMP==I corrected.
// 0.5 Khairul Basar    20-Sep-2009 CC-09/023  Regenerated to add SQ_FINISH flag.
//                                             In Last step valves always to be closed.
//                                             Previously Valves were left open if SQ_OFF.
// 0.4 Khairul Basar    25-Aug-2009 CC-09/023  Change in Verific,& TRN code OR to AND
//                                             Change in the Last step.RunTimer Added.
// 0.3 David Paspa/     24-Aug-2009 CC-09/023  Removed repeated
//     Khairul Basar                           setup steps.
// 0.2 Khairul Basar    18-Aug-2009            Added logic code
// 0.1 David Paspa      13-Jul-2009            SFC structural design

SFCCommCode:- //comm from Visio

--------------------------------------------------
PARAMETER::1
--------------------------------------------------
Name:- time_flush_begin
Type:- TOD
Description:- Logging FLUSH operation start time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::2
--------------------------------------------------
Name:- log_time_flush_begin
Type:- BOOL
Description:- Flags the HMI that FLUSH started
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::3
--------------------------------------------------
Name:- time_flush_end
Type:- TOD
Description:- Logging FLUSH operation end time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::4
--------------------------------------------------
Name:- log_time_flush_end
Type:- BOOL
Description:- Flags the HMI that FLUSH ended
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::5
--------------------------------------------------
Name:- runtime
Type:- TIME
Description:- Flushing run time
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::6
--------------------------------------------------
Name:- pos_pw_state
Type:- INT
Description:- PW supply valve state
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::7
--------------------------------------------------
Name:- pos_wfi_state
Type:- INT
Description:- WFI supply valve state
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::8
--------------------------------------------------
Name:- pos_pspw_state
Type:- INT
Description:- PS PW valve state
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::9
--------------------------------------------------
Name:- pos_pswfi_state
Type:- INT
Description:- PS WFI valve_state
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::10
--------------------------------------------------
Name:- pos_pswfi_cmd
Type:- INT
Description:- PS supply for WFI loop cmd
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::11
--------------------------------------------------
Name:- pos_pspw_cmd
Type:- INT
Description:- PS supply for PW loop valve cmd
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::12
--------------------------------------------------
Name:- pos_pw_cmd
Type:- INT
Description:- PW supply valve cmd
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::13
--------------------------------------------------
Name:- pos_wfi_cmd
Type:- INT
Description:- WFI supply valve cmd
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::14
--------------------------------------------------
Name:- medium
Type:- INT
Description:- Medium to be flush
ParameterInOut:- IN


--------------------------------------------------
STEP::01
--------------------------------------------------
StepNo:- 01
Title:- PH_EMC3_FLUSH : FLUSH begin.
Description:- Log FLUSH operation begin time.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log FLUSH operation begin time.
Action:- //Log FLUSH operation begin time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_flush_begin;

SET;
S #_log_time_flush_begin;

//Start timer
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;

//Load flush time
L #_runtime;
T #SQ_TIMER.PT;
Verification:- A "uncondJump";


--------------------------------------------------
TRANSITION::01
--------------------------------------------------
TRNNo:- 01
Title:- PW medium selected.
EmptyTransition:- False
Description:- Check if PW medium selected.
Condition:- A(;
L "dbCONST".SEL.LIQUID.PW;
L  #_medium;
==I;
);


--------------------------------------------------
TRANSITION::02
--------------------------------------------------
TRNNo:- 02
Title:- WFI medium selected.
EmptyTransition:- False
Description:- Check if WFI medium selected.
Condition:- A(;
L "dbCONST".SEL.LIQUID.WFI;
L  #_medium;
==I;
);


--------------------------------------------------
TRANSITION::03
--------------------------------------------------
TRNNo:- 03
Title:- PSPW medium selected.
EmptyTransition:- False
Description:- Check if PSPW medium selected.
Condition:- A(;
L "dbCONST".SEL.LIQUID.PSPW;
L  #_medium;
==I;
);


--------------------------------------------------
TRANSITION::04
--------------------------------------------------
TRNNo:- 04
Title:- PSWFI medium selected.
EmptyTransition:- False
Description:- Check if PSWFI medium selected.
Condition:- A(;
L "dbCONST".SEL.LIQUID.PSWFI;
L  #_medium;
==I;
);


--------------------------------------------------
STEP::02
--------------------------------------------------
StepNo:- 02
Title:- PH_EMC3_FLUSH : Open PW supply valve
Description:- Open PW supply valve

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open PW supply valve
Action:- //Open PW supply valve.
L  "dbCONST".BLK.POSx.CMD.OPEN;
T  #_pos_pw_cmd;

Verification:- // Verify selected medium and valve state.
A(;
L "dbCONST".SEL.LIQUID.PW;
L  #_medium;
==I;
);
A(;
L "dbCONST".BLK.POSx.STATE.OPENED;
L  #_pos_pw_state;
==I;
);



--------------------------------------------------
STEP::03
--------------------------------------------------
StepNo:- 03
Title:- PH_EMC3_FLUSH : Open WFI supply valve
Description:- Open WFI supply valve

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open WFI supply valve
Action:- //Open WFI supply valve.
L  "dbCONST".BLK.POSx.CMD.OPEN;
T  #_pos_wfi_cmd;

Verification:- // Verify selected medium and valve state.
A(;
L "dbCONST".SEL.LIQUID.WFI;
L  #_medium;
==I;
);
A(;
L "dbCONST".BLK.POSx.STATE.OPENED;
L  #_pos_wfi_state;
==I;
);



--------------------------------------------------
STEP::04
--------------------------------------------------
StepNo:- 04
Title:- PH_EMC3_FLUSH : Open PS(PW) supply valve
Description:- Open PS(PW) supply valve

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open PS(PW) supply valve
Action:- //Open PS(PW) supply valve.
L  "dbCONST".BLK.POSx.CMD.OPEN;
T  #_pos_pspw_cmd;

Verification:- // Verify selected medium and valve state.
A(;
L "dbCONST".SEL.LIQUID.PSPW;
L  #_medium;
==I;
);
A(;
L "dbCONST".BLK.POSx.STATE.OPENED;
L  #_pos_pspw_state;
==I;
);


--------------------------------------------------
STEP::05
--------------------------------------------------
StepNo:- 05
Title:- PH_EMC3_FLUSH : Open PS(WFI) supply valve
Description:- Open PS(WFI) supply valve

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open PS(WFI) supply valve
Action:- //Open PS(WFI) supply valve.
L  "dbCONST".BLK.POSx.CMD.OPEN;
T  #_pos_pswfi_cmd;

Verification:- // Verify selected medium and valve state.
A(;
L "dbCONST".SEL.LIQUID.PSWFI;
L  #_medium;
==I;
);
A(;
L "dbCONST".BLK.POSx.STATE.OPENED;
L  #_pos_pswfi_state;
==I;
);


--------------------------------------------------
TRANSITION::05
--------------------------------------------------
TRNNo:- 05
Title:- Wait for flush time
EmptyTransition:- False
Description:- Jump if flush time has expired.
Condition:- // Flushing time expired.
A #SQ_TIMER.Q;


--------------------------------------------------
STEP::06
--------------------------------------------------
StepNo:- 06
Title:- PH_EMC3_FLUSH : Last Step
Description:- Last Step

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Reset the timer and close PW, WFI, PS_PW and PS_WFI valves.
Action:- // Close PW, WFI, PS_PW, PS_WFI valves.
L "dbCONST".BLK.POSx.CMD.CLOSE;
T  #_pos_pw_cmd;
T  #_pos_wfi_cmd;
T  #_pos_pspw_cmd;
T  #_pos_pswfi_cmd;

//Log FLUSH end time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_flush_end;

SET;
S #_log_time_flush_end;

Verification:- A "uncondJump";

****************************************************************************************************
END SSS REPORT
****************************************************************************************************
