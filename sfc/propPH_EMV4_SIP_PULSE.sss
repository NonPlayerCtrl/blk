****************************************************************************************************
SEQUENCE STEP SCHEDULE
generated on 20/3/2018 5:19:50 PM by MAC_IZZ
****************************************************************************************************





--------------------------------------------------
SEQUENCE
--------------------------------------------------

Name:- SIP_PULSE
Title:- PH_EMX4_SIP_PULSE
Description:- Open and close valve for specified duration.
Class:- PH
Level:- EMV4
STEP_LIST_FORMAT:- JU    S0@@STEP_NUM@@; // STEP-0@@STEP_NUM@@:
ACT_LIST_FORMAT:- JU    @@ACT_CODE@@@@STEP_NUM@@; //ACTION-@@ACT_NUM@@
HeaderName:- X4SPUL
Version:- 0.5
RevisionHistory:- // SFC Revision History:
// Rev By               Date        CC         Note
// 0.1 David Paspa      13-Jul-2009            SFC structural design
HMI_FORMAT:- @@STEP_NUM_INT@@,@@STEP_TITLE@@

--------------------------------------------------
PARAMETER::1
--------------------------------------------------
Name:- time_closed
Type:- TIME
Description:- Valve close time setpoint
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::2
--------------------------------------------------
Name:- pos_sip_state
Type:- INT
Description:- SIP Drain valve state
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::3
--------------------------------------------------
Name:- pos_sip_cmd
Type:- INT
Description:- SIP Drain valve command
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::4
--------------------------------------------------
Name:- time_opened
Type:- TIME
Description:- Valve open time setpoint
ParameterInOut:- IN


--------------------------------------------------
STEP::01
--------------------------------------------------
StepNo:- 01
Title:- PH_EMX4_SIP_PULSE: Open valve
Description:- Open SIP valve 1 for a specified time.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open valve 1 for a specified time.
Action:- //Load setpoint for valve open duration.
L #_time_opened;
T #SQ_TIMER.PT;

//Open valve 01
L   "dbCONST".CM.CMD_VALVE.OPEN;
T  #_pos_sip_cmd;

//Start timer
SET;
S #SQ_TIMER.IN;
Verification:- //Valve 01 opened.
A(;
L   "dbCONST".CM.POS_DEV_STATE.OPENED;
L  #_pos_sip_state;
==I;
);


--------------------------------------------------
TRANSITION::01
--------------------------------------------------
TRNNo:- 01
Title:- Wait until timer expired
EmptyTransition:- False
Description:- Wait until delay time expired
Condition:- //Continue the sequence after the time delay expired.
A #SQ_TIMER.Q;


--------------------------------------------------
STEP::02
--------------------------------------------------
StepNo:- 02
Title:- PH_EMX4_SIP_PULSE : Close valve
Description:- Close SIP drain valve.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Close valve 1.
Action:- SET;
R #SQ_TIMER.IN;

//Close valve 01
L   "dbCONST".CM.CMD_VALVE.CLOSE;
T  #_pos_sip_cmd;

//Load setpoint for valve open duration.
L #_time_closed;
T #SQ_TIMER.PT;

Verification:- //Valve 01 closed.
A(;
L   "dbCONST".CM.POS_DEV_STATE.CLOSED;
L #_pos_sip_state;
==I;
);


--------------------------------------------------
TRANSITION::02
--------------------------------------------------
TRNNo:- 02
Title:- Unconditional Jump
EmptyTransition:- False
Description:- Unconditional Jump
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::03
--------------------------------------------------
StepNo:- 03
Title:- PH_EMX4_SIP_PULSE : Start timer
Description:- Start timer

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Start timer
Action:- //Start timer
SET;
S #SQ_TIMER.IN;
Verification:- A M1.1;


--------------------------------------------------
TRANSITION::03
--------------------------------------------------
TRNNo:- 03
Title:- Last Step
EmptyTransition:- False
Description:- Last Step
Condition:- AN M1.1; //Always High flag


--------------------------------------------------
TRANSITION::04
--------------------------------------------------
TRNNo:- 04
Title:- Wait until timer expired
EmptyTransition:- False
Description:- Wait until delay time expired
Condition:- A #SQ_TIMER.Q; 


--------------------------------------------------
STEP::04
--------------------------------------------------
StepNo:- 04
Title:- PH_EMX4_SIP_PULSE : Reset timer
Description:- Reset timer

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Last Step
Action:- SET;
R #SQ_TIMER.IN;
Verification:- A M1.1;


--------------------------------------------------
TRANSITION::05
--------------------------------------------------
TRNNo:- 05
Title:- Unconditional Jump
EmptyTransition:- False
Description:- Unconditional Jump
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::05
--------------------------------------------------
StepNo:- 05
Title:- PH_EMX4_SIP_PULSE : Last Step
Description:- Last Step

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Last Step
Action:- SET;
R #SQ_TIMER.IN;
Verification:- A M1.1;

****************************************************************************************************
END SSS REPORT
****************************************************************************************************
